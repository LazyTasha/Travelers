<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	<mapper namespace="db">
		<!-- user DB -->
		<select id="getUsers" parameterType="java.util.Map" resultType="db.UserDataBean">
			select user_id,user_name,email,gender,reg_date,r 
			from (
				select user_id,user_name,email,gender,reg_date,rownum r from (
					select user_id,user_name,email,gender,reg_date from gg_user order by reg_date desc) 
					order by reg_date desc)where r &gt;= #{start} and r &lt;=#{end}
		</select>
		<select id="getUCount" resultType="int">
			select count(*) from gg_user
		</select>
		<select id="getUserName" parameterType="String">
			select user_name from gg_user where user_id=#{id}
		</select>
		
		<select id="getUserId" parameterType="String" resultType="String">
			select user_id from gg_user where user_name=#{user_name}
		</select>
		
		<!-- tag DB-->
		<select id="getTagList" resultType="java.util.Map">
			select * from gg_tag
		</select>
		
		<!-- board DB-->
		<select id="getCount" parameterType="int" resultType="int">
			select count(*) from gg_trip_board
		</select>
		<select id="getTrip" parameterType="int" resultType="db.TripDataBean">
			select * from gg_trip_board where tb_no=#{tb_no}
		</select>
		<select id="getTripTags" parameterType="int" resultType="java.util.List">
			select tag_value from gg_tag t, gg_trip_tag tr where t.tag_id=tr.tag_id and tr.tb_no=#{num}
		</select>
		<update id="addViewCount" parameterType="int">
			update gg_tb_board set tb_v_count=tb_v_count+1 where tb_no=#{tb_no}
		</update>
		<insert id="writeTrip" parameterType="db.TbDataBean">
			insert into gg_trip_board 
			(tb_no, user_id, tb_title, tb_content, tb_reg_date, tb_v_count, tb_m_num, tb_notice, tb_talk) 
			values(SEQ_GG_TRIP_BOARD_TB_NO.nextval, #{user_id}, #{tb_title}, #{tb_content}, sysdate, #{tb_v_count}, #{tb_m_num}, #{tb_notice}, #{tb_talk})
		</insert>
		<insert id="setTripTags" parameterType="java.util.Map">
			insert into gg_trip_tag (tb_no, tag_id) values
			<foreach item="item" collection="list" separator=",">
				(#{item.tb_no}, #{item.tag_id})
			</foreach>
		</insert>
	</mapper>